<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>請求書データExcel出力</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', 'Noto Sans JP', sans-serif;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <div class="container mx-auto p-4 sm:p-6 lg:p-8">
        <div class="bg-white p-6 rounded-2xl shadow-lg">
            <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6">
                <h1 class="text-2xl sm:text-3xl font-bold text-gray-900">請求内容一覧</h1>
                <button id="exportBtn" class="mt-4 sm:mt-0 w-full sm:w-auto bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg shadow transition-transform transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50">
                    Excelに出力 (CSV)
                </button>
            </div>

            <!-- Data Table -->
            <div class="overflow-x-auto">
                <table class="min-w-full bg-white divide-y divide-gray-200 rounded-lg">
                    <thead class="bg-gray-100">
                        <tr>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">
                                品名・単価・数量
                            </th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider">
                                金額（税込）
                            </th>
                        </tr>
                    </thead>
                    <tbody id="billing-table-body" class="divide-y divide-gray-200">
                        <!-- Table rows will be inserted here by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // Data extracted from the PDF as per the user's request.
        const billingData = [
            { description: "品名: PCWL-0410 - 受入検査作業費, 単価: ¥1,500, 数量: 1", amount: "¥1,650" },
            { description: "品名: PCWL-0410 - ACアダプタ発送業務, 単価: ¥270, 数量: 1", amount: "¥297" },
            { description: "品名: PCWL-0510 - 受入検査作業費, 単価: ¥1,900, 数量: 40", amount: "¥83,600" },
            { description: "品名: PCWL-0510 - ACアダプタ発送業務, 単価: ¥270, 数量: 1", amount: "¥297" },
            { description: "品名: PCWL-0530E - 受入検査作業費, 単価: ¥1,900, 数量: 57", amount: "¥119,130" },
            { description: "品名: PCWL-0530E - ID/OD識別作業費, 単価: ¥300, 数量: 57", amount: "¥18,810" },
            { description: "品名: PCWL-0530E - 指向性アンテナ発送業務, 単価: ¥230, 数量: 15", amount: "¥3,795" },
            { description: "品名: PCWL-0501 - 受入検査作業費, 単価: ¥1,000, 数量: 38", amount: "¥41,800" },
            { description: "品名: PCWL-0511 - 受入検査作業費, 単価: ¥1,000, 数量: 47", amount: "¥51,700" },
            { description: "品名: 送料 - 6月分送料(PCWL-0410), 単価: ¥2,650, 数量: 1", amount: "¥2,915" },
            { description: "品名: 送料 - 6月分送料(PCWL-0500), 単価: ¥4,700, 数量: 1", amount: "¥5,170" },
            { description: "品名: 送料 - 6月分送料(PCWL-0510), 単価: ¥17,650, 数量: 1", amount: "¥19,415" },
            { description: "品名: 送料 - 6月分送料(PCWL-0530E), 単価: ¥10,050, 数量: 1", amount: "¥11,055" },
            { description: "品名: 送料 - 6月分送料(エクシオ様), 単価: ¥1,600, 数量: 1", amount: "¥1,760" },
            { description: "品名: 送料 - 6月分送料(指向性アンテナ), 単価: ¥4,000, 数量: 1", amount: "¥4,400" },
            { description: "品名: その他 - 保管費用(PicoCELA様), 単価: ¥3,000, 数量: 40.5", amount: "¥133,650" },
            { description: "品名: その他 - 保管費用(エクシオ様), 単価: ¥3,000, 数量: 1.5", amount: "¥4,950" },
            { description: "品名: その他 - 部材入出荷等追加費用, 単価: ¥16,685, 数量: 1", amount: "¥18,354" },
            { description: "品名: その他 - 部材発送, 単価: ¥750, 数量: 8", amount: "¥6,600" }
        ];

        // Function to populate the table with the data
        function populateTable() {
            const tableBody = document.getElementById('billing-table-body');
            tableBody.innerHTML = ''; // Clear existing rows before adding new ones
            billingData.forEach(item => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-50';
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-normal text-sm text-gray-700">${item.description}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-700">${item.amount}</td>
                `;
                tableBody.appendChild(row);
            });
        }

        // Function to export the data to a CSV file
        function exportToCsv(filename, rows) {
            // CSV Header
            const header = ['品名・単価・数量', '金額（税込）'];
            // Process each row to be CSV-friendly
            const processRow = row => "${row.description.replace(/"/g, '""')}","${row.amount}";

            let csvContent = header.join(',') + '\n' + rows.map(processRow).join('\n');
            
            // Add BOM to ensure Japanese characters are displayed correctly in Excel
            const bom = new Uint8Array([0xEF, 0xBB, 0xBF]);
            const blob = new Blob([bom, csvContent], { type: 'text/csv;charset=utf-8;' });
            
            const link = document.createElement("a");
            if (link.download !== undefined) {
                const url = URL.createObjectURL(blob);
                link.setAttribute("href", url);
                link.setAttribute("download", filename);
                link.style.visibility = 'hidden';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            }
        }

        // Add event listener to the export button
        document.getElementById('exportBtn').addEventListener('click', () => {
            exportToCsv('billing_summary.csv', billingData);
        });
        
        // Populate the table when the page loads
        window.onload = populateTable;
    </script>
</body>
</html>