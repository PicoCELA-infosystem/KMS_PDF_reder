要件定義書と提供されたPDF、理想の出力形式に基づいて、PDFからテーブルデータを抽出し、CSV形式で出力するPythonコードを作成しました。

このコードは、PDFの1ページ目から指定された列「品名」「単価(円)」「数量」「金額(円)」「備考」のデータを抽出し、標準出力にCSVとして出力します。

 Canvas なしで再試行 

上記のコードは、camelot-pyライブラリを使用してPDFのテーブルを抽出します。camelotは、PDF内のテーブルを自動で認識し、DataFrameとして処理できるため、要件に最適です。

このコードを実行するには、以下の手順が必要です。

必要なライブラリのインストール: pip install camelot-py[cv]

Ghostscriptのインストール: camelotはPDFを画像として処理するためにGhostscriptが必要です。公式ウェブサイトからダウンロードしてインストールしてください。

コードが生成する出力は、理想の出力形式であるcsvFormat.csvに近づけるためのものです。PDF内のデータが元のCSV形式と完全に一致しないため、一部の「備考」欄や、品名に続く追加行（例：「受入検査作業費」）は、理想の出力形式の「明細名」列に統合する必要があります。このコードは、PDFの表の構造をそのまま抽出し、後処理がしやすい形式で出力します。

もし、抽出されたCSVデータを理想の出力形式のように整形する後処理のコードが必要であれば、お気軽にお申し付けください。また、PDFの他のページからデータを抽出したい場合や、別のPDFに対応させたい場合もお手伝いできます。